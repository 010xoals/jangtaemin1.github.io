<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>음악 소개 홈페이지</title>
  <meta name="description" content="K-POP / J-POP / POP — 올해·이달·금주·오늘의 음악 추천(각 5곡)">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f7f7fb; --card:#fff; --text:#111; --muted:#666; --line:#e5e7eb; --brand:#111; --brand-weak:#222;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:Pretendard, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif; background:linear-gradient(#fff, var(--bg)); color:var(--text)}
    a{color:inherit}
    .container{max-width:1140px; margin:0 auto; padding:0 16px}
    header{position:sticky; top:0; z-index:10; background:#ffffffcc; backdrop-filter:saturate(180%) blur(8px); border-bottom:1px solid var(--line)}
    .h-wrap{display:flex; align-items:center; justify-content:space-between; padding:12px 0}
    .brand{display:flex; gap:10px; align-items:center}
    .logo{width:36px; height:36px; border-radius:12px; background:var(--brand); color:#fff; display:grid; place-items:center; font-weight:700}
    nav.tabs{display:flex; gap:6px}
    .tab{border:1px solid var(--line); border-radius:12px; padding:8px 12px; font-size:14px; background:#fff; cursor:pointer}
    .tab.active{background:var(--brand); color:#fff; border-color:var(--brand)}

    .subtabs{display:flex; gap:8px; padding:14px 0}
    .subtab{border:1px solid var(--line); border-radius:999px; padding:8px 12px; font-size:14px; background:#fff; cursor:pointer}
    .subtab.active{background:#111; color:#fff}

    .grid{display:grid; grid-template-columns:repeat(1, minmax(0,1fr)); gap:16px}
    @media(min-width:640px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:1024px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media(min-width:1280px){.grid{grid-template-columns:repeat(5,1fr)}}

    .card{background:var(--card); border:1px solid var(--line); border-radius:16px; overflow:hidden; box-shadow:0 6px 16px rgba(0,0,0,.04)}
    .cover{aspect-ratio:1/1; width:100%; background:#eee; object-fit:cover}
    .pad{padding:14px}
    .row{display:flex; align-items:center; justify-content:space-between; gap:8px}
    .title{font-weight:600; font-size:15px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    .badge{display:inline-block; border:1px solid var(--line); color:#444; padding:2px 8px; border-radius:999px; font-size:11px}
    .meta{color:var(--muted); font-size:13px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    .iframe-wrap{margin-top:8px; border-radius:12px; overflow:hidden; background:#000; aspect-ratio:16/9}
    .btn{width:100%; margin-top:8px; border:1px solid var(--line); border-radius:12px; padding:10px 12px; background:#fff; cursor:pointer; font-size:13px}
    .btn:hover{background:#f7f7f9}

    .section{margin:28px 0}
    .section h2{font-size:18px; font-weight:600; margin:0 0 10px}
    .section .caption{font-size:12px; color:var(--muted)}

    .hero{padding:24px 0}
    .hero h1{font-size:28px; margin:0 0 6px}
    .hero p{margin:0; color:#444}

    .detail{max-width:920px; margin:24px auto; background:#fff; border:1px solid var(--line); border-radius:18px; overflow:hidden}
    .detail .head{display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid var(--line)}
    .detail .body{padding:16px}
    .detail .grid2{display:grid; grid-template-columns:1fr; gap:16px}
    @media(min-width:860px){.detail .grid2{grid-template-columns:1fr 1fr}}
    .detail .lyrics{white-space:pre-wrap; font-size:14px; color:#333; line-height:1.6}

    footer{border-top:1px solid var(--line); margin-top:40px; padding:14px 0; font-size:12px; color:#666}
    .hidden{display:none !important}
    .pill{display:inline-block; font-size:11px; border:1px solid var(--line); padding:2px 8px; border-radius:999px; background:#fafafa}
    .link{color:#0b57d0; text-decoration:underline}
  </style>
</head>
<body>
  <header>
    <div class="container h-wrap">
      <div class="brand">
        <div class="logo">Mu</div>
        <strong>음악 소개</strong>
      </div>
      <nav class="tabs" id="topTabs">
        <button class="tab" data-route="#/">메인</button>
        <button class="tab" data-route="#/kpop">K-POP</button>
        <button class="tab" data-route="#/jpop">J-POP</button>
        <button class="tab" data-route="#/pop">POP</button>
      </nav>
    </div>
  </header>

  <main class="container" id="app">
    <!-- 콘텐츠가 여기에 렌더링됩니다 -->
  </main>

  <footer>
    <div class="container">
      <div style="display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap">
        <span>© <span id="year"></span> 음악 소개. 제작: jangtaemin1.com</span>
        <span class="pill">K-POP · J-POP · POP — 올해/이달/금주/오늘 5곡 추천</span>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // -------- 데이터 스키마 --------
    // Track: { id, title, artist, releasedAt(YYYY-MM-DD), lyrics, youtube, cover }
    // DB: { [genre]: { year: Track[], month: Track[], week: Track[], day: Track[] } }

    const GENRES = [
      { key: 'kpop', label: 'K-POP' },
      { key: 'jpop', label: 'J-POP' },
      { key: 'pop',  label: 'POP'   },
    ];
    const PERIODS = [
      { key: 'year',  label: '올해의 음악 추천' },
      { key: 'month', label: '이달의 음악 추천' },
      { key: 'week',  label: '금주의 음악 추천' },
      { key: 'day',   label: '오늘의 음악 추천' },
    ];

    // 샘플 5곡을 자동 생성하는 헬퍼
    function makeFiveTracks(prefix, baseDate, coverSeed) {
      const arr = [];
      for (let i = 1; i <= 5; i++) {
        const dt = new Date(baseDate);
        dt.setDate(dt.getDate() - i);
        const y = dt.getFullYear();
        const m = String(dt.getMonth()+1).padStart(2, '0');
        const d = String(dt.getDate()).padStart(2, '0');
        arr.push({
          id: `${prefix}-${i}`,
          title: `${prefix} ${i}`,
          artist: `Artist ${i}`,
          releasedAt: `${y}-${m}-${d}`,
          lyrics: '가사는 저작권을 준수해 필요한 범위(짧은 발췌)만 공개하세요.',
          youtube: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
          cover: `https://picsum.photos/seed/${coverSeed}${i}/600/600`
        });
      }
      return arr;
    }

    const todayStr = new Date().toISOString().slice(0,10);

    const DB = {
      kpop: {
        year:  makeFiveTracks('K-POP 올해의',  new Date('2025-09-30'), 'kpy'),
        month: makeFiveTracks('K-POP 이달의', new Date('2025-10-12'), 'kpm'),
        week:  makeFiveTracks('K-POP 금주의', new Date('2025-10-12'), 'kpw'),
        day:   makeFiveTracks('K-POP 오늘의', new Date('2025-10-12'), 'kpd').map((t,i)=>({...t, releasedAt: todayStr}))
      },
      jpop: {
        year:  makeFiveTracks('J-POP 올해의',  new Date('2025-09-15'), 'jpy'),
        month: makeFiveTracks('J-POP 이달의', new Date('2025-10-11'), 'jpm'),
        week:  makeFiveTracks('J-POP 금주의', new Date('2025-10-12'), 'jpw'),
        day:   makeFiveTracks('J-POP 오늘의', new Date('2025-10-12'), 'jpd').map((t,i)=>({...t, releasedAt: todayStr}))
      },
      pop: {
        year:  makeFiveTracks('POP 올해의',  new Date('2025-08-28'), 'py'),
        month: makeFiveTracks('POP 이달의', new Date('2025-10-10'), 'pm'),
        week:  makeFiveTracks('POP 금주의', new Date('2025-10-12'), 'pw'),
        day:   makeFiveTracks('POP 오늘의', new Date('2025-10-12'), 'pd').map((t,i)=>({...t, releasedAt: todayStr}))
      }
    };

    // -------- 유틸 --------
    function getYouTubeId(url) {
      try {
        const u = new URL(url);
        if (u.hostname.includes('youtu.be')) return u.pathname.slice(1);
        const v = u.searchParams.get('v');
        if (v) return v;
        const parts = u.pathname.split('/').filter(Boolean);
        if (parts[0]==='embed' && parts[1]) return parts[1];
        return null;
      } catch(e){ return null; }
    }
    function el(html){ const t=document.createElement('template'); t.innerHTML=html.trim(); return t.content.firstElementChild; }
    function escapeHtml(s=''){ return s.replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c])); }

    // -------- 렌더러 --------
    function renderMain(){
      const wrap = el(`
        <div>
          <section class="hero">
            <h1>음악 소개 홈페이지</h1>
            <p>K-POP · J-POP · POP 장르별로 올해/이달/금주/오늘의 추천 5곡을 소개합니다.</p>
          </section>
          <div class="section">
            <h2>빠른 이동</h2>
            <div class="grid">
              ${GENRES.map(g=>`
                <a class="card" href="#/${g.key}">
                  <img class="cover" src="https://picsum.photos/seed/hero-${g.key}/800/800" alt="${g.label} 이미지" />
                  <div class="pad">
                    <div class="row">
                      <div class="title">${g.label}</div>
                      <span class="badge">바로가기</span>
                    </div>
                    <p class="meta">올해 · 이달 · 금주 · 오늘 5곡</p>
                  </div>
                </a>`).join('')}
            </div>
          </div>
        </div>
      `);
      return wrap;
    }

    function renderGenre(genreKey){
      const genre = GENRES.find(g=>g.key===genreKey) || GENRES[0];
      const state = { period: 'year', query:'', sort:'recent' };

      const root = el(`<div></div>`);

      const subtabs = el(`
        <div class="subtabs" role="tablist" aria-label="추천 기간">
          ${PERIODS.map(p=>`<button class="subtab" data-key="${p.key}">${p.label}</button>`).join('')}
        </div>
      `);
      root.appendChild(subtabs);

      const toolbar = el(`
        <div style="display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap">
          <input id="q" placeholder="검색: 곡명, 아티스트, 가사…" style="flex:1; min-width:240px; border:1px solid var(--line); border-radius:12px; padding:10px 12px; font-size:14px" />
          <div style="display:flex; align-items:center; gap:8px">
            <label class="meta">정렬</label>
            <select id="sort" style="border:1px solid var(--line); border-radius:12px; padding:10px 12px; font-size:14px">
              <option value="recent">최신 발매순</option>
              <option value="old">오래된 발매순</option>
              <option value="title">제목 A→Z</option>
              <option value="artist">아티스트 A→Z</option>
            </select>
          </div>
        </div>
      `);
      root.appendChild(toolbar);

      const section = el(`<div class="section"><h2>${PERIODS.find(p=>p.key===state.period).label}</h2><div class="caption">총 5곡</div><div class="grid" id="grid"></div></div>`);
      root.appendChild(section);

      function drawSubtabs(){
        subtabs.querySelectorAll('.subtab').forEach(btn=>{
          btn.classList.toggle('active', btn.dataset.key===state.period);
        });
      }
      function getData(){
        let arr = [...(DB[genre.key][state.period]||[])];
        if (state.query){
          const q = state.query.toLowerCase();
          arr = arr.filter(t => [t.title, t.artist, t.lyrics||''].some(x => (x||'').toLowerCase().includes(q)));
        }
        if (state.sort==='recent') arr.sort((a,b)=>b.releasedAt.localeCompare(a.releasedAt));
        if (state.sort==='old')    arr.sort((a,b)=>a.releasedAt.localeCompare(b.releasedAt));
        if (state.sort==='title')  arr.sort((a,b)=>a.title.localeCompare(b.title));
        if (state.sort==='artist') arr.sort((a,b)=>a.artist.localeCompare(b.artist));
        return arr;
      }
      function card(t){
        const vid = getYouTubeId(t.youtube);
        return el(`
          <article class="card">
            <img class="cover" src="${escapeHtml(t.cover||'')}" alt="${escapeHtml(t.title)} cover" />
            <div class="pad">
              <div class="row">
                <div class="title" title="${escapeHtml(t.title)}">${escapeHtml(t.title)}</div>
                <span class="badge">${escapeHtml(t.releasedAt)}</span>
              </div>
              <div class="meta" title="${escapeHtml(t.artist)}">${escapeHtml(t.artist)}</div>
              ${vid ? `<div class="iframe-wrap"><iframe width="100%" height="100%" src="https://www.youtube.com/embed/${vid}" title="${escapeHtml(t.title)}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>` : ''}
              ${t.lyrics ? `<p class="meta" style="margin-top:6px">${escapeHtml(t.lyrics)}</p>` : ''}
              <a class="btn" href="#/track/${genre.key}/${state.period}/${encodeURIComponent(t.id)}">자세히 보기</a>
            </div>
          </article>
        `);
      }
      function draw(){
        section.querySelector('h2').textContent = PERIODS.find(p=>p.key===state.period).label;
        const grid = section.querySelector('#grid');
        grid.innerHTML = '';
        getData().forEach(t=>grid.appendChild(card(t)));
      }

      // events
      subtabs.addEventListener('click', (e)=>{
        if (e.target.closest('.subtab')){
          state.period = e.target.closest('.subtab').dataset.key;
          drawSubtabs();
          draw();
        }
      });
      toolbar.querySelector('#q').addEventListener('input', (e)=>{ state.query = e.target.value; draw(); });
      toolbar.querySelector('#sort').addEventListener('change', (e)=>{ state.sort = e.target.value; draw(); });

      // init
      drawSubtabs();
      draw();
      return root;
    }

    function renderTrackDetail(genreKey, periodKey, id){
      const t = (DB[genreKey] && DB[genreKey][periodKey] || []).find(x=>String(x.id)===String(id));
      if (!t){
        return el(`<div class="section"><h2>곡을 찾을 수 없습니다.</h2><p class="meta"><a class="link" href="#/${genreKey}">← ${genreKey.toUpperCase()} 페이지로 돌아가기</a></p></div>`);
      }
      const vid = getYouTubeId(t.youtube);
      const wrap = el(`
        <article class="detail">
          <div class="head">
            <strong>${escapeHtml(t.title)}</strong>
            <a class="pill" href="#/${genreKey}">목록으로</a>
          </div>
          <div class="body">
            <div class="grid2">
              <div>
                <div class="iframe-wrap">${vid ? `<iframe width="100%" height="100%" src="https://www.youtube.com/embed/${vid}" title="${escapeHtml(t.title)}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>` : `<div style="display:grid;place-items:center;color:#fff; height:100%">YouTube 링크 없음</div>`}</div>
                <p style="margin:10px 0 0"><a class="link" target="_blank" rel="noreferrer" href="${escapeHtml(t.youtube)}">YouTube에서 열기 ↗</a></p>
              </div>
              <div>
                <img class="cover" style="border-radius:14px" src="${escapeHtml(t.cover||'')}" alt="cover" />
                <p style="margin:10px 0 0"><span class="badge">발매일: ${escapeHtml(t.releasedAt)}</span> <span class="badge">뮤지션: ${escapeHtml(t.artist)}</span></p>
                ${t.lyrics ? `<div style="margin-top:12px"><h3 style="margin:0 0 6px; font-size:15px">가사(발췌)</h3><div class="lyrics">${escapeHtml(t.lyrics)}</div></div>`: ''}
              </div>
            </div>
          </div>
        </article>
      `);
      return wrap;
    }

    // -------- 라우터 (해시) --------
    function setActiveTab(route){
      document.querySelectorAll('#topTabs .tab').forEach(btn=>{
        btn.classList.toggle('active', btn.dataset.route===route);
      });
    }

    function render(){
      const root = document.getElementById('app');
      const hash = location.hash || '#/'
      const seg = hash.replace(/^#\//,'').split('/');
      // 경로: #/           → 메인
      // 경로: #/kpop       → 장르 페이지
      // 경로: #/track/:g/:p/:id → 곡 상세(별동 페이지)

      if (seg[0]==='track'){
        setActiveTab(`#/${seg[1]||''}`);
        root.innerHTML='';
        root.appendChild(renderTrackDetail(seg[1], seg[2], decodeURIComponent(seg[3]||'')));
        return;
      }

      if (seg[0]==='kpop' || seg[0]==='jpop' || seg[0]==='pop'){
        setActiveTab(`#/${seg[0]}`);
        root.innerHTML='';
        root.appendChild(renderGenre(seg[0]));
        return;
      }

      // default: 메인
      setActiveTab('#/');
      root.innerHTML='';
      root.appendChild(renderMain());
    }

    window.addEventListener('hashchange', render);
    document.getElementById('topTabs').addEventListener('click', (e)=>{
      const btn = e.target.closest('.tab');
      if (!btn) return;
      location.hash = btn.dataset.route;
    });

    // 초기 렌더링
    if (!location.hash) location.hash = '#/'
    render();
  </script>
</body>
</html>
